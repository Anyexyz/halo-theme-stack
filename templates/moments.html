<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" th:replace="~{modules/layout :: html(content = ~{::content}, title='瞬间', pageType='moments' )}">
<th:block th:fragment="content">
    <div class="container main-container flex on-phone--column extended">
        <!--      Left Sidebar-->
        <th:block th:replace="~{modules/common/left-sidebar :: left-sidebar}"></th:block>


        <main class="main full-width">
            <div class="moments-container">
                <h2 class="moments-title">
                    <i class="icon stack icon-pengyouquan1"></i>
                    瞬间
                </h2>
                <div class="tags-list">
                    <a th:href="@{/moments}" class="tags-item">
                        <span>全部</span>
                    </a>
                    <a th:href="'/moments?tag='+${tag.name}" class="tags-item" th:each="tag : ${tags}">
                        <span th:text="${tag.name}"></span>
                        <span class="tag-num" th:text="${tag.momentCount}"></span>
                    </a>
                </div>
                <div class="moment-content">
                    <ul>
                        <li th:each="moment : ${moments.items}" th:with="content=${moment.spec.content}">
                            <img th:src="${theme.config.leftSidebar.blog_info.avatar}" alt="" class="avatar">
                            <div class="content" >
                                <div class="item-content" th:if="${not #strings.isEmpty(content.html)}">
                                    <div class="item-html " th:utext="${content.html}">

                                    </div>
                                    <div class="moment-media"
                                         th:if="${not #lists.isEmpty(content.medium)}"
                                         th:classappend="${'medium-'+#lists.size(content.medium)}">
                                            <th:block th:each="momentItem : ${content.medium}">
                                                <div class="moment-media-item">
                                                <img th:if="${momentItem.type.name == 'PHOTO'}" th:src="${momentItem.url}" loading="lazy"/>
                                                    <video th:if="${momentItem.type.name == 'VIDEO'}"
                                                           id="my-player"
                                                            class="video-js"
                                                            controls
                                                            preload="auto"
                                                            width="600"
                                                            height="400"
                                                            data-setup='{}'>
                                                        <source th:src="${momentItem.url}" type="video/mp4"></source>
                                                    </video>
                                                </div>
                                            </th:block>
                                    </div>
                                </div>
                            </div>

                        </li>
                    </ul>
                </div>
            </div>
            <div class="moment-pagination" th:if="${moments.hasPrevious() || moments.hasNext()}">
                <a class="pre" th:href="@{${moments.prevUrl}}" th:if="${moments.hasPrevious()}">
                    <span>上一页</span>
                    <i class="icon jiewen joe-left"></i>

                </a>
                <a class="next" th:href="@{${moments.nextUrl}}" th:if="${moments.hasNext()}">
                    <span>下一页</span>
                    <i class="icon jiewen joe-right"></i>
                </a>
            </div>
            <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
            <script>
                document.addEventListener("DOMContentLoaded", function() {
                    const currentSearch = window.location.search;
                    const tagsLinks = document.querySelectorAll('.tags-list a');
                    tagsLinks.forEach(function(link) {
                        link.classList.remove('active');
                        const href = new URL(link.href, window.location.origin);
                        const linkSearch = href.search;

                        // 检查链接的查询字符串是否与当前页面匹配
                        if (currentSearch === linkSearch) {
                            link.classList.add('active');
                        }else if(currentSearch === '' && linkSearch === ''){
                            link.classList.add('active');
                        }
                    });
                });

            </script>

            <!--Footer-->
            <th:block th:replace="~{modules/common/footer :: footer}"></th:block>



        </main>
    </div>
    <!--    Tail JS-->
    <th:block th:replace="~{modules/tail :: tail}"></th:block>


</th:block>
</html>